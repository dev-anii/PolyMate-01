<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://kit.fontawesome.com/504da92e23.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="style.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"></script>
  <title>Polymate - Bot</title>
</head>
<body>
  <!-- Navbar Started -->
  <nav class="navbar navbar-expand-lg ">
    <div class="container-fluid">
      <a class="navbar-brand" href="/" id="logoName">PolyMate.</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link active" href="#">Home</a></li>
          <li class="nav-item"><a class="nav-link active" href="#" onclick="handleCommingSoon()">About us</a></li>
          <li class="nav-item"><a class="nav-link active" onclick="handleCommingSoon()">InsightBot</a></li>
          <li class="nav-item"><a class="nav-link active" id="userLoginName"></a></li>
        </ul>
        <form class="d-flex gap-2" role="search">
          <button class="btn btn-primary" type="submit" onclick="handleCommingSoon()">Docs</button>
          <button class="btn btn-success" type="button" onclick="goToLogin()">Login</button>
        </form>
      </div>
    </div>
  </nav>
  <!-- Navbar Ended -->

  <!-- Bot Started -->
  <div class="container-main-bot">
    <div class="question-container">
      <h3>Let’s make things easier - ask me anything!</h3>
      <br />
      <input type="text" id="questionInput" placeholder="Can you write a love letter to coffee for me?" />
      <button type="button" class="btn btn-warning" onclick="handleGemini()">Ask</button>
    </div>
    <div class="Answer-container">
      You : <span id="displayedQuestion"></span>
      <br /><br />
      PolyMate :
      <div id="answerDisplay"></div>
    </div>
  </div>
  <!-- Bot Ended -->

  <footer>
    Made with ❤️ by us
  </footer>

  <!-- Gemini SDK -->
  <script type="module">
    import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

    window.GoogleGenerativeAI = GoogleGenerativeAI;
  </script>

  <!-- Main Script (non-module so it can access imported SDK) -->
  <script>
    let username;
    let email;
    function handleCommingSoon() {
      alert("Coming Soon!");
    }

    function goToLogin() {
      window.location.href = "login.html";
    }

    window.onload = function () {
      username = localStorage.getItem("username");
      email = localStorage.getItem("email");
      const question = localStorage.getItem("question");

      if (!username) {
        window.location.href = "login.html";
        return;
      }

      const userLoginName = document.getElementById("userLoginName");
      if (userLoginName) {
        userLoginName.innerText = `Welcome, ${username}`;
      }

      const displayedQuestion = document.getElementById("displayedQuestion");
      if (displayedQuestion && question) {
        displayedQuestion.innerText = question;
      }
    };

    async function handleGemini() {
      const questionInput = document.getElementById("questionInput");
      const question = questionInput.value.trim();

      if (!question) {
        alert("Please enter a question.");
        return;
      }

      // Display and store the question
      localStorage.setItem("question", question);
      const displayedQuestion = document.getElementById("displayedQuestion");
      if (displayedQuestion) displayedQuestion.innerText = question;

      const answerElement = document.getElementById("answerDisplay");
      if (answerElement) answerElement.innerText = "Thinking...";

      try {
          const curriculum = {
            "1stSem": {
              "AppliedMathematicsI": ["Mathematical Functions", "Differentiation", "Integration", "Linear Algebra"],
              "ComputerProgramming": ["Intro to Computers", "C Basics", "Control Structures", "Functions & Arrays"],
              "EngineeringPhysics": ["Mechanics", "Waves & Optics", "Electricity & Magnetism", "Semiconductor Physics"],
              "EngineeringChemistry": ["Water Chemistry", "Organic Chemistry", "Industrial Chemistry", "Environmental Chemistry"],
              "BasicElectricalEngineering": ["DC Circuits", "AC Circuits", "Electric Machines", "Transformers"],
              "EnglishCommunication": ["Grammar", "Writing Skills", "Listening Skills", "Oral Communication"]
            },
            "2ndSem": {
              "AppliedMathematicsII": ["Differential Equations", "Fourier Transforms", "Probability", "Vector Analysis"],
              "ComputerOrganization": ["Computer Org", "ALU", "Control Unit", "Memory & I/O"],
              "DataStructures": ["Intro to Data Structures", "Arrays & Linked Lists", "Stacks & Queues", "Searching & Sorting"],
              "DiscreteMathematics": ["Set Theory", "Logic & Proofs", "Graph Theory", "Combinatorics"],
              "DigitalElectronics": ["Number Systems", "Boolean Algebra", "Circuits", "Flip-Flops"],
              "EngineeringDrawing": ["Geometrical Constructions", "Projection", "Sectional Views", "Isometric Drawing"]
            },
            "3rdSem": {
              "ObjectOrientedProgramming": ["OOP Concepts", "Classes & Objects", "Inheritance & Polymorphism", "Exception Handling"],
              "OperatingSystems": ["OS Concepts", "Process Management", "Memory Management", "File Systems"],
              "DatabaseSystems": ["DB Concepts", "SQL", "Normalization", "Transactions & Concurrency"],
              "ComputerNetworks": ["Protocols", "Networking Devices", "Routing", "Network Security"],
              "Microprocessors": ["8085", "Assembly Programming", "Interrupts", "8051 Microcontroller"],
              "EnvironmentalStudies": ["Environmental Awareness", "Natural Resources", "Pollution Control", "Sustainable Development"]
            },
            "4thSem": {
              "DataCommunication": ["Transmission Media", "Modulation", "Error Detection", "Protocols"],
              "SoftwareEngineering": ["SDLC", "Design", "Testing", "Quality Metrics"],
              "WebTechnologies": ["HTML, CSS, JS", "Web Frameworks", "Server-Side Scripting", "Databases in Web"],
              "ComputerGraphics": ["Graphics Fundamentals", "Graphics Transformation", "2D & 3D Systems", "Rendering"],
              "Algorithms": ["Introduction", "Divide & Conquer", "Greedy", "Dynamic Programming"],
              "IndustrialManagement": ["Management", "Product Design", "Marketing", "Entrepreneurship"]
            },
            "5thSem": {
              "MobileDevelopment": ["Mobile Dev Intro", "UI/UX", "Android Basics", "Cloud Integration"],
              "CloudComputing": ["Cloud Intro", "Virtualization", "Cloud Models", "Cloud Security"],
              "AdvancedDataStructures": ["Graphs & Trees", "Searching Techniques", "Heaps", "Dynamic Programming"],
              "EthicalHacking": ["Cyber Security", "Ethical Hacking", "Cryptography", "Security Policies"],
              "AIandML": ["AI Basics", "Machine Learning", "Supervised & Unsupervised", "Neural Networks"],
              "ProjectWork": ["Based on selected project"]
            },
            "6thSem": {
              "IoT": ["IoT Intro", "IoT Architectures", "Sensors & Actuators", "Applications"],
              "SystemSoftware": ["Assembler", "Linker", "Compiler Parsing", "Optimization"],
              "BigDataAnalytics": ["Big Data Intro", "Hadoop", "Data Analysis", "Real-Time Data"],
              "AdvancedWebTech": ["HTML5, CSS3", "Web Services", "JS Frameworks", "Web Security"],
              "SoftwareProjectManagement": ["Planning", "Risk Management", "Quality Assurance", "Agile & Scrum"],
              "Internship": ["Industry Projects"]
            }
          };
        const genAI = new window.GoogleGenerativeAI("API-ADD-Here"); 
        const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });

        const result = await model.generateContent("i am going to use ask you questions realated to MSBTE syllabus and polytechnic studies ,"+curriculum+" this is the points you can refer and if dont get the answer from refer points you can use your own knowledge regarding to topic or MSBTE Syllabus and polytechnic, and your developed by Annirudh Kasar and Vinayak Kausadikar with the help of Google api and my question is "+question);
        const response = await result.response;
        const text = await response.text();

        if (answerElement) answerElement.innerText = text;
      } catch (error) {
        console.error("Error:", error);
        if (answerElement) answerElement.innerText = "Oops! Something went wrong.";
      }
    }
  </script>
</body>
</html>
